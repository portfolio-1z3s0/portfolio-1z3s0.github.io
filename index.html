<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>作品ポートフォリオ | 仮タイトル</title>
  <meta name="description" content="ポートフォリオ雛形。" />
  <meta property="og:title" content="作品ポートフォリオ" />
  <meta property="og:description" content="ポートフォリオ雛形。" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="assets/img/og-placeholder.jpg" />
  <!-- ↑OG画像、SNSのカードになるやつ -->
  <meta name="theme-color" content="#111827" />
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <header>
    <div class="wrap nav">
      <div class="brand">
        <span class="brand-dot" aria-hidden="true"></span>
        <a href="/" aria-current="page">作品ポートフォリオ</a>
      </div>
      <nav>
        <a class="link" href="/" aria-current="page">最新</a>
        <a class="link" href="pages/all.html">一覧</a>
        <a class="link" href="pages/about.html">概要</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero wrap" aria-labelledby="hero-h">
      <h1 id="hero-h">最新作 / Featured</h1>
      <p>友人の作品を紹介する個人運営サイトの雛形。データは <code>data/artworks.json</code> から読み込みます。</p>
      <div class="toolbar" role="region" aria-label="作品の検索と並び替え">
        <input id="q" class="input" type="search" placeholder="タイトル / タグで検索" aria-label="検索" />
        <select id="sort" class="select" aria-label="並び順">
          <option value="date-desc">新しい順</option>
          <option value="date-asc">古い順</option>
          <option value="title-asc">タイトル A→Z</option>
          <option value="title-desc">タイトル Z→A</option>
        </select>
        <button id="clear" class="btn" type="button">クリア</button>
      </div>
    </section>

    <section class="section wrap" aria-labelledby="latest-h">
      <h2 id="latest-h">最新作</h2>
      <div id="grid" class="grid" aria-live="polite" aria-busy="true"></div>
      <p id="empty" class="notice" style="display:none">検索条件に一致する作品がありません。</p>
      <div id="loadNotice" class="notice" style="margin-top:12px; display:none"></div>
    </section>
  </main>

  <footer>
    <div class="wrap footer-inner">
      <div class="credits">© <span id="year"></span> 仮タイトル</div>
      <div class="links">
        <a href="pages/privacy.html">プライバシーポリシー</a>
        <a href="pages/terms.html">利用規約</a>
        <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>
      </div>
    </div>
  </footer>

  <!--
    データの用意：data/artworks.json を作る
    例：
    [
      {
        "id": "sculpt-001",
        "title": "青の静物",
        "artist": "Your Friend",
        "year": 2024,
        "date": "2024-12-15",
        "tags": ["彫刻", "木彫"],
        "thumb": "assets/img/blue-still-thumb.jpg",
        "image": "assets/img/blue-still.jpg",
        "description": "青を基調とした木彫作品。",
        "featured": true
      }
    ]

    ※ 初期はデータが無くても動作するよう、下の <script id="sampleData"> をフォールバックとして使用します。
  -->
  <script id="sampleData" type="application/json">[
    {
      "id": "sample-001",
      "title": "サンプル作品 A",
      "artist": "Sample Artist",
      "year": 2025,
      "date": "2025-07-01",
      "tags": ["彫刻", "木彫"],
      "thumb": "assets/img/sample-a-thumb.jpg",
      "image": "assets/img/sample-a.jpg",
      "description": "プレビュー用のダミーデータ。",
      "featured": true
    },
    {
      "id": "sample-002",
      "title": "サンプル作品 B",
      "artist": "Sample Artist",
      "year": 2024,
      "date": "2024-11-10",
      "tags": ["絵画", "油彩"],
      "thumb": "assets/img/sample-b-thumb.jpg",
      "image": "assets/img/sample-b.jpg",
      "description": "プレビュー用のダミーデータ。",
      "featured": true
    },
    {
      "id": "sample-003",
      "title": "サンプル作品 C",
      "artist": "Sample Artist",
      "year": 2023,
      "date": "2023-05-20",
      "tags": ["デッサン"],
      "thumb": "assets/img/sample-c-thumb.jpg",
      "image": "assets/img/sample-c.jpg",
      "description": "プレビュー用のダミーデータ。",
      "featured": false
    }
  ]</script>

  <script>
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));

    const state = { items: [], filtered: [], query: '', sort: 'date-desc' };

    const els = {
      grid: $('#grid'),
      empty: $('#empty'),
      loadNotice: $('#loadNotice'),
      q: $('#q'),
      sort: $('#sort'),
      clear: $('#clear'),
    };

    function byDateDesc(a,b){ return new Date(b.date) - new Date(a.date); }
    function byDateAsc(a,b){ return new Date(a.date) - new Date(b.date); }
    function byTitleAsc(a,b){ return a.title.localeCompare(b.title, 'ja'); }
    function byTitleDesc(a,b){ return b.title.localeCompare(a.title, 'ja'); }

    function render(items){
      els.grid.setAttribute('aria-busy', 'false');
      els.grid.innerHTML = '';
      if(!items.length){ els.empty.style.display = 'block'; return; }
      els.empty.style.display = 'none';
      for(const x of items){
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <a href="pages/detail.html?id=${encodeURIComponent(x.id)}" class="thumb ${x.thumb? '': 'skeleton'}" aria-label="${x.title}">
            ${x.thumb ? `<img src="${x.thumb}" alt="${x.title} のサムネイル">` : ''}
          </a>
          <div class="meta">
            <div>
              <div class="title">${x.title}</div>
              <div class="sub">${x.artist ?? ''} · ${x.year ?? ''}</div>
            </div>
            <div class="tags">${(x.tags||[]).slice(0,3).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
          </div>
        `;
        els.grid.appendChild(card);
      }
    }

    function applyFilters(){
      const q = state.query.trim().toLowerCase();
      let arr = [...state.items].filter(x => x.featured !== false); // デフォルトは featured を優先
      if(q){
        arr = arr.filter(x =>
          (x.title||'').toLowerCase().includes(q) ||
          (x.tags||[]).some(t => (t||'').toLowerCase().includes(q))
        );
      }
      switch(state.sort){
        case 'date-desc': arr.sort(byDateDesc); break;
        case 'date-asc': arr.sort(byDateAsc); break;
        case 'title-asc': arr.sort(byTitleAsc); break;
        case 'title-desc': arr.sort(byTitleDesc); break;
      }
      state.filtered = arr.slice(0, 12); // 最新 12 件
      render(state.filtered);
    }

    async function loadData(){
      const path = 'data/artworks.json';
      els.loadNotice.style.display = 'block';
      els.loadNotice.textContent = `読み込み中…（${path} が無ければサンプルを使用）`;
      try {
        const res = await fetch(path, { cache: 'no-store' });
        if(!res.ok) throw new Error('no data file');
        state.items = await res.json();
        els.loadNotice.style.display = 'none';
      } catch (e){
        const fallback = $('#sampleData');
        state.items = JSON.parse(fallback.textContent);
        els.loadNotice.textContent = 'data/artworks.json が見つからないため、サンプルデータで表示しています。';
      }
      applyFilters();
    }

    function bindUI(){
      els.q.addEventListener('input', (e)=>{ state.query = e.target.value; applyFilters(); });
      els.sort.addEventListener('change', (e)=>{ state.sort = e.target.value; applyFilters(); });
      els.clear.addEventListener('click', ()=>{ state.query=''; els.q.value=''; state.sort='date-desc'; els.sort.value='date-desc'; applyFilters(); });
      $('#year').textContent = new Date().getFullYear();
    }

    bindUI();
    loadData();
  </script>
</body>
</html>




